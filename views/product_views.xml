<?xml version="1.0" encoding="utf-8"?>
<odoo>
    
    <!-- EXTENDER FORMULARIO DE PRODUCTOS -->
    <record id="view_product_template_form_optica" model="ir.ui.view">
        <field name="name">product.template.form.optica</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_only_form_view"/>
        <field name="arch" type="xml">
            
            <!-- Agregar checkbox -->
            <xpath expr="//field[@name='detailed_type']" position="after">
                <field name="es_lente" widget="boolean_toggle"/>
            </xpath>
            
            <!-- Agregar pestaña -->
            <xpath expr="//notebook" position="inside">
                <page string="📐 Datos Ópticos" attrs="{'invisible': [('es_lente', '=', False)]}">
                    
                    <group>
                        <group string="Clasificación">
                            <field name="laboratorio_id" 
                                   attrs="{'required': [('es_lente', '=', True)]}"
                                   options="{'no_create': True}"/>
                            <field name="serie_rx" 
                                   attrs="{'required': [('es_lente', '=', True)]}"/>
                            <field name="tipo_lente" 
                                   attrs="{'required': [('es_lente', '=', True)]}"/>
                            <field name="material"/>
                            <field name="tipo_fabricacion"/>
                        </group>
                        
                        <group string="Rangos de Graduación Soportados">
                            <label for="esfera_min" string="Esfera"/>
                            <div class="o_row">
                                <field name="esfera_min" 
                                       class="oe_inline"
                                       attrs="{'required': [('es_lente', '=', True)]}"/> 
                                <span class="oe_inline"> a </span>
                                <field name="esfera_max" 
                                       class="oe_inline"
                                       attrs="{'required': [('es_lente', '=', True)]}"/>
                            </div>
                            
                            <label for="cilindro_min" string="Cilindro"/>
                            <div class="o_row">
                                <field name="cilindro_min" 
                                       class="oe_inline"
                                       attrs="{'required': [('es_lente', '=', True)]}"/>
                                <span class="oe_inline"> a </span>
                                <field name="cilindro_max" 
                                       class="oe_inline"
                                       attrs="{'required': [('es_lente', '=', True)]}"/>
                            </div>
                        </group>
                    </group>
                    
                    <group>
                        <div class="alert alert-info" role="alert">
                            <strong>💡 Ejemplo:</strong> Si este lente acepta graduaciones de 
                            <strong>-2.00 a +2.00</strong> de esfera, ingresa:<br/>
                            • Esfera Min: <code>-2.00</code><br/>
                            • Esfera Max: <code>+2.00</code>
                        </div>
                    </group>
                    
                </page>
            </xpath>
            
        </field>
    </record>
    
</odoo>
