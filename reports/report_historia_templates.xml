<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <template id="report_historia_document">
    <t t-call="web.html_container">
      <t t-foreach="docs" t-as="doc">
        <t t-call="web.external_layout">
          <div class="page">
            
            <!-- ESTILOS ID√âNTICOS AL TICKET -->
            <style>
              .ticket-header {
                border-bottom: 3px solid #2c3e50;
                padding-bottom: 10px;
                margin-bottom: 20px;
              }
              .ticket-title {
                color: #2c3e50;
                font-size: 24px;
                font-weight: bold;
                margin-bottom: 5px;
              }
              .ticket-subtitle {
                color: #7f8c8d;
                font-size: 14px;
              }
              .info-section {
                background-color: #f8f9fa;
                border-left: 4px solid #3498db;
                padding: 15px;
                margin-bottom: 20px;
                border-radius: 0 5px 5px 0;
              }
              .section-title {
                color: #2c3e50;
                font-size: 18px;
                font-weight: bold;
                margin-bottom: 15px;
                padding-bottom: 5px;
                border-bottom: 2px solid #ecf0f1;
              }
              .table-custom {
                border: 1px solid #dee2e6;
                font-size: 14px;
                border-radius: 5px;
                overflow: hidden;
              }
              .table-custom thead {
                background-color: #2980b9;
                color: white;
              }
              .table-custom th {
                border: none;
                padding: 12px 10px;
                text-align: center;
                font-weight: bold;
                font-size: 15px;
                letter-spacing: 0.5px;
              }
              .table-custom td {
                padding: 10px;
                text-align: center;
                vertical-align: middle;
                border: 1px solid #dee2e6;
              }
              .row-white {
                background-color: white;
              }
              .row-gray {
                background-color: #f8f9fa;
                font-weight: bold;
              }
              .data-label {
                font-weight: bold;
                color: #2c3e50;
                min-width: 120px;
                display: inline-block;
              }
            </style>

            <div class="row">
              <div class="col-12">
                
                <!-- ENCABEZADO ID√âNTICO AL TICKET -->
                <div class="ticket-header">
                  <div class="ticket-title">Historia Cl√≠nica ‚Äî <span t-field="doc.paciente_id.display_name"/></div>
                  <div class="ticket-subtitle">√ìptica Zamora - Centro de Salud Visual</div>
                </div>
                
                <!-- INFORMACI√ìN B√ÅSICA - MISMO ESTILO -->
                <div class="info-section">
                  <div class="row">
                    <div class="col-6">
                      <p><span class="data-label">Paciente:</span> <span t-field="doc.paciente_id.display_name"/></p>
                      <p><span class="data-label">Fecha Evaluaci√≥n:</span> <span t-field="doc.fecha"/></p>
                      <p><span class="data-label">Optometrista:</span> <span t-field="doc.profesional.display_name"/></p>
                    </div>
                    <div class="col-6">
                      <p><span class="data-label">Diagn√≥stico:</span> <span t-field="doc.diagnostico"/></p>
                      <p><span class="data-label">Tipo de Lente:</span> <span t-field="doc.tipo_lente"/></p>
                    </div>
                  </div>
                </div>

                <!-- GRADUACI√ìN - TABLA ID√âNTICA AL TICKET -->
                <h3 class="section-title">üìä Graduaci√≥n √ìptica</h3>
                <table class="table table-sm table-bordered table-custom">
                  <thead>
                    <tr>
                      <th></th>
                      <th>ESF</th>
                      <th>CIL</th>
                      <th>EJE</th>
                      <th>ADD</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr class="row-gray">
                      <td><strong>OD</strong></td>
                      <td><span t-field="doc.ojo_derecho_esfera"/></td>
                      <td><span t-field="doc.ojo_derecho_cilindro"/></td>
                      <td><span t-field="doc.ojo_derecho_eje"/></td>
                      <td><span t-field="doc.adicion"/></td>
                    </tr>
                    <tr class="row-white">
                      <td><strong>OI</strong></td>
                      <td><span t-field="doc.ojo_izquierdo_esfera"/></td>
                      <td><span t-field="doc.ojo_izquierdo_cilindro"/></td>
                      <td><span t-field="doc.ojo_izquierdo_eje"/></td>
                      <td><span t-field="doc.adicion"/></td>
                    </tr>
                  </tbody>
                </table>

                <!-- AGUDEZA VISUAL - TABLA SIMILAR -->
                <h3 class="section-title">üëÅÔ∏è Agudeza Visual</h3>
                <table class="table table-sm table-bordered table-custom">
                  <thead>
                    <tr>
                      <th></th>
                      <th>AV</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr class="row-gray">
                      <td><strong>OD</strong></td>
                      <td><t t-esc="doc.ojo_derecho_av or '-'"/></td>
                    </tr>
                    <tr class="row-white">
                      <td><strong>OI</strong></td>
                      <td><t t-esc="doc.ojo_izquierdo_av or '-'"/></td>
                    </tr>
                  </tbody>
                </table>

                <!-- DATOS ADICIONALES - TABLA ID√âNTICA AL TICKET -->
                <div t-if="doc.distancia_interpupilar or doc.distancia_nasopupilar_od or doc.distancia_nasopupilar_oi or doc.altura_centro_optico">
                  <h3 class="section-title">üìê Datos Adicionales</h3>
                  <table class="table table-sm table-bordered table-custom">
                    <tbody>
                      <tr class="row-gray" t-if="doc.distancia_interpupilar">
                        <td width="30%"><strong>DIP</strong></td>
                        <td><span t-field="doc.distancia_interpupilar"/> mm</td>
                      </tr>
                      <tr class="row-white" t-if="doc.distancia_nasopupilar_od">
                        <td><strong>DNP OD</strong></td>
                        <td><span t-field="doc.distancia_nasopupilar_od"/> mm</td>
                      </tr>
                      <tr class="row-gray" t-if="doc.distancia_nasopupilar_oi">
                        <td><strong>DNP OI</strong></td>
                        <td><span t-field="doc.distancia_nasopupilar_oi"/> mm</td>
                      </tr>
                      <tr class="row-white" t-if="doc.altura_centro_optico">
                        <td><strong>Alt. CO</strong></td>
                        <td><span t-field="doc.altura_centro_optico"/> mm</td>
                      </tr>
                    </tbody>
                  </table>
                </div>

                <!-- OBSERVACIONES - ESTILO SIMILAR -->
                <div class="mt-3" t-if="doc.observaciones">
                  <p><strong>üìù Observaciones:</strong></p>
                  <p t-esc="doc.observaciones"/>
                </div>

                <!-- PIE DE P√ÅGINA SIMILAR -->
                <div style="margin-top: 30px; padding-top: 10px; border-top: 1px solid #ecf0f1; text-align: center; color: #7f8c8d; font-size: 12px;">
                  <p>Documento generado el <span t-esc="datetime.datetime.now().strftime('%d/%m/%Y %H:%M')"/> ‚Ä¢ √ìptica Zamora</p>
                </div>

              </div>
            </div>
          </div>
        </t>
      </t>
    </t>
  </template>
</odoo>
